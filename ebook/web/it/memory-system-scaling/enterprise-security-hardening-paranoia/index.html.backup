<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise Security Hardening ‚Äì Dalla Fiducia alla Paranoia | Memory System Scaling | AI Team Orchestrator</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Capitolo 40 del libro AI Team Orchestrator: Enterprise Security Hardening ‚Äì Dalla Fiducia alla Paranoia">
    <meta name="keywords" content="AI agents, sistema AI-driven, architettura AI, OpenAI SDK, team AI">
    <meta name="author" content="Daniele Pelleri">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Enterprise Security Hardening ‚Äì Dalla Fiducia alla Paranoia">
    <meta property="og:description" content="Capitolo 40 del libro AI Team Orchestrator: Enterprise Security Hardening ‚Äì Dalla Fiducia alla Paranoia">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://books.danielepelleri.com/it/memory-system-scaling/enterprise-security-hardening-paranoia/">
    
    <!-- Canonical -->
    <link rel="canonical" href="https://books.danielepelleri.com/it/memory-system-scaling/enterprise-security-hardening-paranoia/">
    <link rel="alternate" hreflang="en" href="https://books.danielepelleri.com/en/memory-system-scaling/enterprise-security-hardening-paranoia/">
    <link rel="alternate" hreflang="it" href="https://books.danielepelleri.com/it/memory-system-scaling/enterprise-security-hardening-paranoia/">
    
    <style>
        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Breadcrumb Navigation */
        .breadcrumb {
            background: rgba(255, 255, 255, 0.9);
            padding: 1rem 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
        }
        
        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        
        .breadcrumb span {
            color: #7f8c8d;
            margin: 0 0.5rem;
        }
        
        /* Chapter Header */
        .chapter-header {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            margin-bottom: 3rem;
            text-align: center;
        }
        
        .chapter-instrument {
            font-size: 4rem;
            margin-bottom: 1rem;
        }
        
        .chapter-meta {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: #7f8c8d;
            flex-wrap: wrap;
        }
        
        .chapter-title {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 1rem;
            font-weight: 700;
            line-height: 1.2;
        }
        
        /* Content Styles */
        .chapter-content {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            margin-bottom: 3rem;
        }
        
        .chapter-content h3 {
            font-size: 2rem;
            color: #2c3e50;
            margin: 2rem 0 1rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 0.5rem;
        }
        
        .chapter-content h4 {
            font-size: 1.5rem;
            color: #495057;
            margin: 1.5rem 0 1rem;
        }
        
        .chapter-content p {
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            line-height: 1.8;
        }
        
        .chapter-content ul, .chapter-content ol {
            margin: 1.5rem 0;
            padding-left: 2rem;
        }
        
        .chapter-content li {
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin: 2rem 0;
        }
        
        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }
        
        th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
        }
        
        /* Code Styles */
        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1.5rem 0;
            font-size: 0.9rem;
        }
        
        code {
            background: #f1f3f4;
            color: #d73a49;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }
        
        pre code {
            background: transparent;
            color: inherit;
            padding: 0;
        }
        
        /* Special Boxes */
        .war-story, .industry-insight, .architecture-section, .key-takeaways-section {
            border-radius: 10px;
            padding: 2rem;
            margin: 2rem 0;
        }
        
        .war-story {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border-left: 4px solid #856404;
        }
        
        .industry-insight {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-left: 4px solid #28a745;
        }
        
        .architecture-section {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 1px solid #dee2e6;
        }
        
        .key-takeaways-section {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
        }
        
        /* Mermaid Container */
        .mermaid {
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 10px;
            margin: 2rem 0;
            text-align: center;
        }
        
        /* Navigation */
        .chapter-nav-bottom {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 3rem 0;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .nav-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .nav-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }
        
        .nav-button.secondary {
            background: rgba(255, 255, 255, 0.9);
            color: #667eea;
            border: 2px solid #667eea;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .nav-button.secondary:hover {
            background: white;
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .chapter-header,
            .chapter-content {
                padding: 2rem;
            }
            
            .chapter-title {
                font-size: 2rem;
            }
            
            .chapter-nav-bottom {
                flex-direction: column;
                text-align: center;
            }
        }
        /* Reader Tools */
        .reader-tools {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            transition: all 0.3s ease;
            min-width: 60px;
        }
        
        .reader-tools.collapsed {
            width: 60px;
            padding: 0.8rem;
        }
        
        .reader-tool {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s ease;
            color: #495057;
            font-size: 0.85rem;
            white-space: nowrap;
        }
        
        .reader-tool:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }
        
        .reader-tool.active {
            background: #667eea;
            color: white;
        }
        
        .reader-tool-icon {
            font-size: 1.1rem;
            flex-shrink: 0;
        }
        
        .reader-tool-label {
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .collapsed .reader-tool-label {
            display: none;
        }
        
        .reader-tools-toggle {
            position: absolute;
            top: -10px;
            left: -10px;
            width: 30px;
            height: 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        /* Language Switcher */
        .language-switcher {
            display: flex;
            background: rgba(0,0,0,0.1);
            border-radius: 6px;
            overflow: hidden;
        }
        
        .language-option {
            padding: 0.3rem 0.6rem;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 0.7rem;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.2s ease;
        }
        
        .language-option.active {
            background: #667eea;
            color: white;
        }
        
        /* Reading Progress */
        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: rgba(102, 126, 234, 0.2);
            z-index: 1001;
        }
        
        .reading-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        /* Dark Mode */
        body.dark-mode {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e9ecef;
        }
        
        .dark-mode .container {
            color: #e9ecef;
        }
        
        .dark-mode .chapter-header,
        .dark-mode .chapter-content {
            background: rgba(255, 255, 255, 0.05);
            color: #e9ecef;
        }
        
        .dark-mode .breadcrumb {
            background: rgba(255, 255, 255, 0.1);
            color: #e9ecef;
        }
        
        .dark-mode .reader-tools {
            background: rgba(0, 0, 0, 0.8);
            color: #e9ecef;
        }
        
        .dark-mode .reader-tool {
            color: #e9ecef;
        }
        
        .dark-mode .reader-tool:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .reader-tools {
                right: 10px;
                padding: 0.8rem;
                min-width: 50px;
            }
            
            .reader-tools.collapsed {
                width: 50px;
                padding: 0.6rem;
            }
            
            .reader-tool {
                padding: 0.5rem;
            }
            
            .reader-tool-label {
                font-size: 0.75rem;
            }
        }

        /* Fixed Bookmark Toast */
        .bookmark-toast {
            position: fixed;
            top: 80px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 0.8rem 1.2rem;
            border-radius: 8px;
            z-index: 1002;
            transform: translateX(350px);
            opacity: 0;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
            pointer-events: none;
        }
        
        .bookmark-toast.show {
            transform: translateX(0);
            opacity: 1;
            pointer-events: auto;
        }
        
        .bookmark-toast.error {
            background: #dc3545;
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }


            /* Reader Tools */
        .reader-tools {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            transition: all 0.3s ease;
            min-width: 60px;
        }
        .reader-tools.collapsed { width: 60px; padding: 0.8rem; }
        .reader-tool { display: flex; align-items: center; gap: 0.5rem; padding: 0.6rem; border: none; background: transparent; cursor: pointer; border-radius: 8px; transition: all 0.2s ease; color: #495057; font-size: 0.85rem; white-space: nowrap; }
        .reader-tool:hover { background: rgba(102, 126, 234, 0.1); color: #667eea; }
        .reader-tool.active { background: #667eea; color: white; }
        .reader-tool-icon { font-size: 1.1rem; flex-shrink: 0; }
        .reader-tool-label { font-size: 0.8rem; font-weight: 500; }
        .collapsed .reader-tool-label { display: none; }
        .reader-tools-toggle { position: absolute; top: -10px; left: -10px; width: 30px; height: 30px; background: #667eea; color: white; border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3); }
        .reading-progress { position: fixed; top: 0; left: 0; width: 100%; height: 3px; background: rgba(102, 126, 234, 0.2); z-index: 1001; }
        .reading-progress-fill { height: 100%; background: linear-gradient(90deg, #667eea, #764ba2); width: 0%; transition: width 0.3s ease; }
        body.dark-mode { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: #e9ecef; }
        .dark-mode .container { color: #e9ecef; }
        .dark-mode .chapter-header, .dark-mode .chapter-content { background: rgba(255, 255, 255, 0.05); color: #e9ecef; }
        .dark-mode .breadcrumb { background: rgba(255, 255, 255, 0.1); color: #e9ecef; }
        .dark-mode .reader-tools { background: rgba(0, 0, 0, 0.8); color: #e9ecef; }
        .dark-mode .reader-tool { color: #e9ecef; }
        .dark-mode .reader-tool:hover { background: rgba(255, 255, 255, 0.1); }
        @media (max-width: 768px) { .reader-tools { right: 10px; padding: 0.8rem; min-width: 50px; } .reader-tools.collapsed { width: 50px; padding: 0.6rem; } .reader-tool { padding: 0.5rem; } .reader-tool-label { font-size: 0.75rem; } }
        .bookmark-toast { position: fixed; top: 80px; right: 20px; background: #28a745; color: white; padding: 0.8rem 1.2rem; border-radius: 8px; z-index: 1002; transform: translateX(300px); transition: transform 0.3s ease; font-size: 0.9rem; box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3); }
        .bookmark-toast.show { transform: translateX(0); }
        .bookmark-toast.error { background: #dc3545; box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3); }
        .bookmarks-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 2000; backdrop-filter: blur(5px); }
        .bookmarks-modal.show { display: flex; align-items: center; justify-content: center; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .bookmarks-content { background: white; border-radius: 20px; padding: 2rem; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .dark-mode .bookmarks-content { background: #1a1a2e; color: #e9ecef; }
        .bookmarks-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid #667eea; }
        .bookmarks-title { font-size: 1.5rem; font-weight: 700; color: #2c3e50; display: flex; align-items: center; gap: 0.5rem; }
        .dark-mode .bookmarks-title { color: #e9ecef; }
        .close-bookmarks { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #7f8c8d; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.2s ease; }
        .close-bookmarks:hover { background: rgba(102, 126, 234, 0.1); color: #667eea; }
        .bookmarks-list { max-height: 400px; overflow-y: auto; }
        .bookmark-item { display: flex; justify-content: space-between; align-items: center; padding: 1rem; border-radius: 10px; margin-bottom: 0.5rem; background: rgba(102, 126, 234, 0.05); transition: all 0.2s ease; }
        .bookmark-item:hover { background: rgba(102, 126, 234, 0.1); transform: translateX(5px); }
        .dark-mode .bookmark-item { background: rgba(255, 255, 255, 0.05); }
        .dark-mode .bookmark-item:hover { background: rgba(255, 255, 255, 0.1); }
        .bookmark-info { flex-grow: 1; }
        .bookmark-title { font-weight: 600; color: #2c3e50; text-decoration: none; font-size: 1rem; line-height: 1.4; }
        .dark-mode .bookmark-title { color: #e9ecef; }
        .bookmark-title:hover { color: #667eea; }
        .bookmark-date { font-size: 0.8rem; color: #7f8c8d; margin-top: 0.3rem; }
        .bookmark-actions { display: flex; gap: 0.5rem; }
        .bookmark-action { background: none; border: none; cursor: pointer; padding: 0.3rem; border-radius: 5px; transition: all 0.2s ease; color: #7f8c8d; }
        .bookmark-action:hover { background: rgba(220, 53, 69, 0.1); color: #dc3545; }
        .empty-bookmarks { text-align: center; padding: 2rem; color: #7f8c8d; }
        .empty-bookmarks-icon { font-size: 3rem; margin-bottom: 1rem; opacity: 0.5; }
        .language-select { background: transparent; border: none; color: inherit; font-size: 0.75rem; font-weight: 600; cursor: pointer; outline: none; min-width: 60px; }
        .language-select option { background: white; color: #2c3e50; }
        .dark-mode .language-select option { background: #1a1a2e; color: #e9ecef; }

    </style>

    <style>
    .contextual-link {
        color: #667eea;
        text-decoration: none;
        font-weight: 500;
        border-bottom: 1px dotted #667eea;
        transition: all 0.2s ease;
    }
    
    .contextual-link:hover {
        color: #5a6fd8;
        border-bottom-style: solid;
    }
    
    .dark-mode .contextual-link {
        color: #9bb5ff;
        border-bottom-color: #9bb5ff;
    }
    </style>
        <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,CiAgICA8c3ZnIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDMyIDMyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogICAgICAgIDxkZWZzPgogICAgICAgICAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImdyYWQxIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj4KICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM2NjdlZWE7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM3NjRiYTI7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgICAgICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgICAgICAgPC9kZWZzPgogICAgICAgIDwhLS0gQmFja2dyb3VuZCBjaXJjbGUgLS0+CiAgICAgICAgPGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTUiIGZpbGw9InVybCgjZ3JhZDEpIiBzdHJva2U9IiNmZmYiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgICAgIDwhLS0gQUkgQnJhaW4gaWNvbiAtLT4KICAgICAgICA8Y2lyY2xlIGN4PSIxNiIgY3k9IjEzIiByPSI4IiBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgICAgIDxjaXJjbGUgY3g9IjEzIiBjeT0iMTEiIHI9IjEiIGZpbGw9IiNmZmYiLz4KICAgICAgICA8Y2lyY2xlIGN4PSIxOSIgY3k9IjExIiByPSIxIiBmaWxsPSIjZmZmIi8+CiAgICAgICAgPHBhdGggZD0iTTEyIDE1YzEgMiAzIDIgNCAyczMgMCA0LTIiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgogICAgICAgIDwhLS0gVGVhbSBvcmNoZXN0cmF0aW9uIGxpbmVzIC0tPgogICAgICAgIDxwYXRoIGQ9Ik04IDI0TDE2IDIwTDI0IDI0IiBzdHJva2U9IiNmZmYiIHN0cm9rZS13aWR0aD0iMiIgZmlsbD0ibm9uZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+CiAgICAgICAgPGNpcmNsZSBjeD0iOCIgY3k9IjI0IiByPSIyIiBmaWxsPSIjZmZmIi8+CiAgICAgICAgPGNpcmNsZSBjeD0iMTYiIGN5PSIyMCIgcj0iMiIgZmlsbD0iI2ZmZiIvPgogICAgICAgIDxjaXJjbGUgY3g9IjI0IiBjeT0iMjQiIHI9IjIiIGZpbGw9IiNmZmYiLz4KICAgIDwvc3ZnPgogICAg">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,CiAgICA8c3ZnIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDMyIDMyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogICAgICAgIDxkZWZzPgogICAgICAgICAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImdyYWQxIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj4KICAgICAgICAgICAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM2NjdlZWE7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgICAgICAgICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM3NjRiYTI7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgICAgICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgICAgICAgPC9kZWZzPgogICAgICAgIDwhLS0gQmFja2dyb3VuZCBjaXJjbGUgLS0+CiAgICAgICAgPGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTUiIGZpbGw9InVybCgjZ3JhZDEpIiBzdHJva2U9IiNmZmYiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgICAgIDwhLS0gQUkgQnJhaW4gaWNvbiAtLT4KICAgICAgICA8Y2lyY2xlIGN4PSIxNiIgY3k9IjEzIiByPSI4IiBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgICAgIDxjaXJjbGUgY3g9IjEzIiBjeT0iMTEiIHI9IjEiIGZpbGw9IiNmZmYiLz4KICAgICAgICA8Y2lyY2xlIGN4PSIxOSIgY3k9IjExIiByPSIxIiBmaWxsPSIjZmZmIi8+CiAgICAgICAgPHBhdGggZD0iTTEyIDE1YzEgMiAzIDIgNCAyczMgMCA0LTIiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgogICAgICAgIDwhLS0gVGVhbSBvcmNoZXN0cmF0aW9uIGxpbmVzIC0tPgogICAgICAgIDxwYXRoIGQ9Ik04IDI0TDE2IDIwTDI0IDI0IiBzdHJva2U9IiNmZmYiIHN0cm9rZS13aWR0aD0iMiIgZmlsbD0ibm9uZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+CiAgICAgICAgPGNpcmNsZSBjeD0iOCIgY3k9IjI0IiByPSIyIiBmaWxsPSIjZmZmIi8+CiAgICAgICAgPGNpcmNsZSBjeD0iMTYiIGN5PSIyMCIgcj0iMiIgZmlsbD0iI2ZmZiIvPgogICAgICAgIDxjaXJjbGUgY3g9IjI0IiBjeT0iMjQiIHI9IjIiIGZpbGw9IiNmZmYiLz4KICAgIDwvc3ZnPgogICAg">
</head>
<body>
    <div class="container">
        <!-- Breadcrumb -->
        <nav class="breadcrumb">
            <a href="../../ai-team-orchestrator.html">üè† AI Team Orchestrator</a>
            <span>‚Ä∫</span>
            <a href="../">üé≠ Memory System Scaling</a>
            <span>‚Ä∫</span>
            <span>Enterprise Security Hardening ‚Äì Dalla Fiducia alla Paranoia</span>
        </nav>

        <!-- Chapter Header -->
        <header class="chapter-header">
            <div class="chapter-instrument">üé≠</div>
            <div class="chapter-meta">
                <span>üé≠ Movimento 4 di 4</span>
                <span>üìñ Capitolo 40 di 42</span>
                <span>‚è±Ô∏è ~13 min lettura</span>
                <span>üìä Livello: Expert</span>
            </div>
            <h1 class="chapter-title">Enterprise Security Hardening ‚Äì Dalla Fiducia alla Paranoia</h1>
        </header>

        <!-- Main Content -->
        <article class="chapter-content">
<p>Il load testing shock aveva risolto i nostri problemi di scalabilit√†, ma aveva anche attirato l'attenzione di clienti enterprise molto pi√π esigenti. Il primo segnale √® arrivato via email alle 09:30 del 25 agosto:</p>

<p><em>"Ciao, siamo molto interessati alla vostra piattaforma per il nostro team di 500+ persone. Prima di procedere, avremmo bisogno di una security review completa, certificazione SOC 2, GDPR compliance audit, e penetration testing da parte di terzi. Quando possiamo schedularla?"</em></p>

<p><strong>Mittente:</strong> Head of IT Security, Fortune 500 Financial Services Company</p>

<p>Il mio primo pensiero √® stato: "Merda, non siamo pronti per questo."</p>

<h3>La Realt√† Check: Da Startup a Enterprise Target</h3>

<p>Fino a quel momento, la nostra sicurezza era quella tipica di una startup: <strong>"Functional but not paranoid"</strong>. Avevamo autenticazione, autorizzazione base, e HTTPS. Per clienti SMB andava bene. Per enterprise finance? Era come presentarsi a un matrimonio in tuta da ginnastica.</p>

<p><em>Security Assessment iniziale (25 Agosto):</em></p>

<pre><code class="language-text">CURRENT SECURITY POSTURE ASSESSMENT:

‚úÖ BASIC (Adequate for SMB):
- User authentication (email/password)
- HTTPS everywhere  
- Basic input validation
- Environment variables for secrets

‚ùå MISSING (Required for Enterprise):
- Multi-factor authentication (MFA)
- Role-based access control (RBAC) granular
- Data encryption at rest
- Audit logging comprehensive
- SOC 2 compliance framework
- Penetration testing
- Incident response procedures
- Data retention/deletion policies

SECURITY MATURITY SCORE: 3/10 (Enterprise requirement: 8+/10)</code></pre>

<p><strong>L'Insight Brutale:</strong> La sicurezza enterprise non √® una feature che aggiungi dopo ‚Äì √® un mindset che permea ogni decisione architetturale. Dovevamo ripensare il sistema da zero con un <strong>security-first approach</strong>.</p>

<h3>Phase 1: Authentication Revolution ‚Äì Da Password a Zero Trust</h3>

<p>Il primo problema da risolvere era l'autenticazione. I clienti enterprise volevano <strong>Multi-Factor Authentication (MFA)</strong>, <strong>Single Sign-On (SSO)</strong>, e integrazione con i loro <strong>Active Directory</strong> esistenti.</p>

<p><em>Codice di riferimento: <code>backend/services/enterprise_auth_manager.py</code></em></p>

<pre><code class="language-python">class EnterpriseAuthManager:
    &quot;&quot;&quot;
    Enterprise-grade authentication system con MFA, SSO, e Zero Trust principles
    &quot;&quot;&quot;
    
    def __init__(self):
        self.mfa_provider = MFAProvider()
        self.sso_integrator = SSOIntegrator()
        self.directory_connector = DirectoryConnector()
        self.zero_trust_enforcer = ZeroTrustEnforcer()
        self.audit_logger = SecurityAuditLogger()
        
    async def authenticate_user(
        self,
        auth_request: AuthenticationRequest,
        security_context: SecurityContext
    ) -&gt; AuthenticationResult:
        &quot;&quot;&quot;
        Multi-layered authentication con risk assessment e adaptive security
        &quot;&quot;&quot;
        # 1. Risk Assessment: Analyze authentication context
        risk_assessment = await self._assess_authentication_risk(auth_request, security_context)
        
        # 2. Primary Authentication (password, SSO, or certificate)
        primary_auth_result = await self._perform_primary_authentication(auth_request)
        if not primary_auth_result.success:
            await self._log_failed_authentication(auth_request, &quot;primary_auth_failure&quot;)
            return AuthenticationResult.failure(&quot;Invalid credentials&quot;)
        
        # 3. Multi-Factor Authentication (adaptive based on risk)
        if risk_assessment.requires_mfa or auth_request.force_mfa:
            mfa_result = await self._perform_mfa_challenge(
                primary_auth_result.user,
                risk_assessment.recommended_mfa_strength
            )
            if not mfa_result.success:
                await self._log_failed_authentication(auth_request, &quot;mfa_failure&quot;)
                return AuthenticationResult.failure(&quot;MFA verification failed&quot;)
        
        # 4. Device Trust Verification
        device_trust = await self._verify_device_trust(
            auth_request.device_fingerprint,
            primary_auth_result.user
        )
        
        # 5. Zero Trust Context Evaluation
        zero_trust_decision = await self.zero_trust_enforcer.evaluate_access_request(
            user=primary_auth_result.user,
            device_trust=device_trust,
            risk_assessment=risk_assessment,
            requested_resources=auth_request.requested_scopes
        )
        
        if zero_trust_decision.action == ZeroTrustAction.DENY:
            await self._log_failed_authentication(auth_request, f&quot;zero_trust_denial: {zero_trust_decision.reason}&quot;)
            return AuthenticationResult.failure(f&quot;Access denied: {zero_trust_decision.reason}&quot;)
        
        # 6. Generate secure session with appropriate permissions
        session_token = await self._generate_secure_session_token(
            user=primary_auth_result.user,
            permissions=zero_trust_decision.granted_permissions,
            device_trust=device_trust,
            session_constraints=zero_trust_decision.session_constraints
        )
        
        # 7. Audit successful authentication
        await self._log_successful_authentication(primary_auth_result.user, auth_request, risk_assessment)
        
        return AuthenticationResult.success(
            user=primary_auth_result.user,
            session_token=session_token,
            granted_permissions=zero_trust_decision.granted_permissions,
            session_expires_at=session_token.expires_at,
            security_warnings=zero_trust_decision.security_warnings
        )
    
    async def _assess_authentication_risk(
        self,
        auth_request: AuthenticationRequest,
        security_context: SecurityContext
    ) -&gt; RiskAssessment:
        &quot;&quot;&quot;
        Comprehensive risk assessment for adaptive security
        &quot;&quot;&quot;
        risk_factors = {}
        
        # Geographic risk: Login from unusual location?
        geographic_risk = await self._assess_geographic_risk(
            auth_request.source_ip,
            auth_request.user_id
        )
        risk_factors[&quot;geographic&quot;] = geographic_risk
        
        # Device risk: Known device or new device?
        device_risk = await self._assess_device_risk(
            auth_request.device_fingerprint,
            auth_request.user_id
        )
        risk_factors[&quot;device&quot;] = device_risk
        
        # Behavioral risk: Unusual access patterns?
        behavioral_risk = await self._assess_behavioral_risk(
            auth_request.user_id,
            auth_request.timestamp,
            auth_request.user_agent
        )
        risk_factors[&quot;behavioral&quot;] = behavioral_risk
        
        # Network risk: Suspicious IP, VPN, Tor?
        network_risk = await self._assess_network_risk(auth_request.source_ip)
        risk_factors[&quot;network&quot;] = network_risk
        
        # Historical risk: Recent security incidents?
        historical_risk = await self._assess_historical_risk(auth_request.user_id)
        risk_factors[&quot;historical&quot;] = historical_risk
        
        # Calculate composite risk score
        composite_risk_score = self._calculate_composite_risk_score(risk_factors)
        
        return RiskAssessment(
            composite_score=composite_risk_score,
            risk_factors=risk_factors,
            requires_mfa=composite_risk_score &gt; 0.6,
            recommended_mfa_strength=self._determine_mfa_strength(composite_risk_score),
            security_recommendations=self._generate_security_recommendations(risk_factors)
        )</code></pre>

<h3>Phase 2: Data Encryption ‚Äì Proteggere i Segreti degli Altri</h3>

<p>Con l'autenticazione enterprise-ready, il passo successivo era la <strong>data encryption</strong>. I clienti enterprise volevano garanzie che i loro dati fossero <strong>encrypted at rest</strong>, <strong>encrypted in transit</strong>, e <strong>encrypted in processing</strong> quando possibile.</p>

<pre><code class="language-python">class EnterpriseDataProtectionManager:
    &quot;&quot;&quot;
    Comprehensive data protection con encryption, key management, e data loss prevention
    &quot;&quot;&quot;
    
    def __init__(self):
        self.encryption_engine = AESGCMEncryptionEngine()
        self.key_management = AWSKMSKeyManager()  # Enterprise KMS integration
        self.data_classifier = DataClassifier()
        self.dlp_engine = DataLossPrevention()
        
    async def protect_sensitive_data(
        self,
        data: Any,
        data_context: DataContext,
        protection_requirements: ProtectionRequirements
    ) -&gt; ProtectedData:
        &quot;&quot;&quot;
        Intelligent data protection basato su classification e requirements
        &quot;&quot;&quot;
        # 1. Classify data sensitivity
        data_classification = await self.data_classifier.classify_data(data, data_context)
        
        # 2. Determine protection strategy based on classification
        protection_strategy = await self._determine_protection_strategy(
            data_classification,
            protection_requirements
        )
        
        # 3. Apply appropriate encryption
        encrypted_data = await self._apply_encryption(
            data,
            protection_strategy.encryption_level,
            data_context
        )
        
        # 4. Generate data protection metadata
        protection_metadata = await self._generate_protection_metadata(
            data_classification,
            protection_strategy,
            encrypted_data
        )
        
        # 5. Store in protected format
        protected_data = ProtectedData(
            encrypted_payload=encrypted_data.ciphertext,
            encryption_metadata=encrypted_data.metadata,
            data_classification=data_classification,
            protection_metadata=protection_metadata,
            access_control_list=await self._generate_access_control_list(data_context)
        )
        
        # 6. Audit data protection
        await self._audit_data_protection(protected_data, data_context)
        
        return protected_data
    
    async def _determine_protection_strategy(
        self,
        classification: DataClassification,
        requirements: ProtectionRequirements
    ) -&gt; ProtectionStrategy:
        &quot;&quot;&quot;
        Choose optimal protection strategy based on data sensitivity and requirements
        &quot;&quot;&quot;
        if classification.sensitivity == SensitivityLevel.TOP_SECRET:
            # Highest protection: AES-256, separate keys per record
            return ProtectionStrategy(
                encryption_level=EncryptionLevel.AES_256_RECORD_LEVEL,
                key_rotation_frequency=KeyRotationFrequency.DAILY,
                backup_encryption=True,
                network_encryption=NetworkEncryption.END_TO_END,
                memory_protection=MemoryProtection.ENCRYPTED_SWAP
            )
            
        elif classification.sensitivity == SensitivityLevel.CONFIDENTIAL:
            # High protection: AES-256, per-workspace keys
            return ProtectionStrategy(
                encryption_level=EncryptionLevel.AES_256_WORKSPACE_LEVEL,
                key_rotation_frequency=KeyRotationFrequency.WEEKLY,
                backup_encryption=True,
                network_encryption=NetworkEncryption.TLS_1_3,
                memory_protection=MemoryProtection.STANDARD
            )
            
        elif classification.sensitivity == SensitivityLevel.INTERNAL:
            # Medium protection: AES-256, per-tenant keys
            return ProtectionStrategy(
                encryption_level=EncryptionLevel.AES_256_TENANT_LEVEL,
                key_rotation_frequency=KeyRotationFrequency.MONTHLY,
                backup_encryption=True,
                network_encryption=NetworkEncryption.TLS_1_3,
                memory_protection=MemoryProtection.STANDARD
            )
            
        else:
            # Basic protection: AES-256, system-wide key
            return ProtectionStrategy(
                encryption_level=EncryptionLevel.AES_256_SYSTEM_LEVEL,
                key_rotation_frequency=KeyRotationFrequency.QUARTERLY,
                backup_encryption=True,
                network_encryption=NetworkEncryption.TLS_1_2,
                memory_protection=MemoryProtection.STANDARD
            )</code></pre>

<h3>"War Story": The GDPR Compliance Emergency</h3>

<p>A settembre, un potenziale cliente europeo ci ha chiesto compliance GDPR completa prima di firmare un contratto da ‚Ç¨200K. Avevamo 3 settimane per implementare tutto.</p>

<p>Il problema era che GDPR non √® solo encryption ‚Äì √® <strong>data lifecycle management</strong>, <strong>right to be forgotten</strong>, <strong>data portability</strong>, e <strong>consent management</strong>. Tutti sistemi che non avevamo.</p>

<pre><code class="language-python">class GDPRComplianceManager:
    &quot;&quot;&quot;
    Comprehensive GDPR compliance con data lifecycle, consent management, e user rights
    &quot;&quot;&quot;
    
    def __init__(self):
        self.consent_manager = ConsentManager()
        self.data_inventory = DataInventoryManager()
        self.right_to_be_forgotten = RightToBeForgottenEngine()
        self.data_portability = DataPortabilityEngine()
        self.audit_trail = GDPRAuditTrail()
        
    async def handle_data_subject_request(
        self,
        request: DataSubjectRequest
    ) -&gt; DataSubjectRequestResult:
        &quot;&quot;&quot;
        Handle GDPR data subject requests (access, rectification, erasure, portability)
        &quot;&quot;&quot;
        # 1. Verify requestor identity
        identity_verification = await self._verify_data_subject_identity(request)
        if not identity_verification.verified:
            return DataSubjectRequestResult.failure(
                &quot;Identity verification failed&quot;,
                required_documents=identity_verification.required_documents
            )
        
        # 2. Locate all data for this subject
        data_inventory = await self.data_inventory.find_all_user_data(request.user_id)
        
        # 3. Process request based on type
        if request.request_type == DataSubjectRequestType.ACCESS:
            return await self._handle_data_access_request(request, data_inventory)
            
        elif request.request_type == DataSubjectRequestType.RECTIFICATION:
            return await self._handle_data_rectification_request(request, data_inventory)
            
        elif request.request_type == DataSubjectRequestType.ERASURE:
            return await self._handle_data_erasure_request(request, data_inventory)
            
        elif request.request_type == DataSubjectRequestType.PORTABILITY:
            return await self._handle_data_portability_request(request, data_inventory)
            
        else:
            return DataSubjectRequestResult.failure(f&quot;Unsupported request type: {request.request_type}&quot;)
    
    async def _handle_data_erasure_request(
        self,
        request: DataSubjectRequest,
        data_inventory: DataInventory
    ) -&gt; DataSubjectRequestResult:
        &quot;&quot;&quot;
        Handle &quot;Right to be Forgotten&quot; requests - complex cascading deletion
        &quot;&quot;&quot;
        # 1. Check if erasure is legally possible
        erasure_assessment = await self._assess_erasure_legality(request, data_inventory)
        if not erasure_assessment.erasure_permitted:
            return DataSubjectRequestResult.partial_success(
                message=&quot;Some data cannot be erased due to legal obligations&quot;,
                retained_data_reason=erasure_assessment.retention_reasons,
                erased_data_categories=[]
            )
        
        # 2. Plan cascading deletion (maintain referential integrity)
        deletion_plan = await self._create_deletion_plan(data_inventory)
        
        # 3. Execute deletion in safe order
        deletion_results = []
        for deletion_step in deletion_plan.steps:
            try:
                # Backup data before deletion (for audit/recovery)
                backup_result = await self._backup_data_for_audit(deletion_step.data_items)
                
                # Execute deletion
                step_result = await self._execute_deletion_step(deletion_step)
                
                # Verify deletion completed
                verification_result = await self._verify_deletion_completion(deletion_step)
                
                deletion_results.append(DeletionStepResult(
                    step=deletion_step,
                    backup_location=backup_result.backup_location,
                    deletion_confirmed=verification_result.confirmed,
                    items_deleted=step_result.items_deleted
                ))
                
            except Exception as e:
                # Rollback partial deletion
                await self._rollback_partial_deletion(deletion_results)
                return DataSubjectRequestResult.failure(
                    f&quot;Deletion failed at step {deletion_step.step_name}: {e}&quot;
                )
        
        # 4. Update consent records
        await self.consent_manager.record_data_erasure(request.user_id, deletion_results)
        
        # 5. Audit trail
        await self.audit_trail.record_erasure_completion(request, deletion_results)
        
        return DataSubjectRequestResult.success(
            message=f&quot;Data erasure completed successfully&quot;,
            affected_data_categories=[r.step.data_category for r in deletion_results],
            deletion_completion_date=datetime.utcnow(),
            audit_reference=await self._generate_audit_reference(request, deletion_results)
        )</code></pre>

<h3>Phase 3: Security Monitoring ‚Äì Il SOC Che Non Dorme Mai</h3>

<p>Con encryption e GDPR in place, avevamo bisogno di <strong>continuous security monitoring</strong>. I clienti enterprise volevano <strong>SIEM integration</strong>, <strong>threat detection</strong>, e <strong>incident response</strong> automatizzato.</p>

<pre><code class="language-python">class EnterpriseSIEMIntegration:
    &quot;&quot;&quot;
    Security Information and Event Management integration
    per continuous threat detection e incident response
    &quot;&quot;&quot;
    
    def __init__(self):
        self.threat_detector = AIThreatDetector()
        self.incident_responder = AutomatedIncidentResponder()
        self.siem_forwarder = SIEMEventForwarder()
        self.behavioral_analyzer = UserBehaviorAnalyzer()
        
    async def continuous_security_monitoring(self) -&gt; None:
        &quot;&quot;&quot;
        24/7 security monitoring con AI-powered threat detection
        &quot;&quot;&quot;
        while True:
            try:
                # 1. Collect security events from all sources
                security_events = await self._collect_security_events()
                
                # 2. Analyze events for threats
                threat_analysis = await self.threat_detector.analyze_events(security_events)
                
                # 3. Detect behavioral anomalies
                behavioral_anomalies = await self.behavioral_analyzer.detect_anomalies(security_events)
                
                # 4. Correlate threats and anomalies
                correlated_incidents = await self._correlate_security_signals(
                    threat_analysis.detected_threats,
                    behavioral_anomalies
                )
                
                # 5. Auto-respond to confirmed incidents
                for incident in correlated_incidents:
                    if incident.confidence &gt; 0.8 and incident.severity &gt;= SeverityLevel.HIGH:
                        await self.incident_responder.auto_respond_to_incident(incident)
                
                # 6. Forward all events to customer SIEM
                await self.siem_forwarder.forward_events(security_events, threat_analysis)
                
                # 7. Generate security dashboard updates
                await self._update_security_dashboard(threat_analysis, behavioral_anomalies)
                
            except Exception as e:
                logger.error(f&quot;Security monitoring error: {e}&quot;)
                await self._alert_security_team(&quot;monitoring_system_error&quot;, str(e))
            
            await asyncio.sleep(30)  # Monitor every 30 seconds
    
    async def _correlate_security_signals(
        self,
        detected_threats: List[DetectedThreat],
        behavioral_anomalies: List[BehavioralAnomaly]
    ) -&gt; List[SecurityIncident]:
        &quot;&quot;&quot;
        AI-powered correlation of security signals into actionable incidents
        &quot;&quot;&quot;
        correlation_prompt = f&quot;&quot;&quot;
        Analizza questi security signals e identifica incident patterns significativi.
        
        DETECTED THREATS ({len(detected_threats)}):
        {self._format_threats_for_analysis(detected_threats)}
        
        BEHAVIORAL ANOMALIES ({len(behavioral_anomalies)}):
        {self._format_anomalies_for_analysis(behavioral_anomalies)}
        
        Identifica:
        1. Coordinated attack patterns (multiple signals pointing to same attacker)
        2. Privilege escalation attempts (behavioral + access anomalies)
        3. Data exfiltration patterns (unusual data access + network activity)
        4. Account compromise indicators (authentication + behavioral anomalies)
        
        Per ogni incident identificato, specifica:
        - Confidence level (0.0-1.0)
        - Severity level (LOW/MEDIUM/HIGH/CRITICAL)
        - Affected assets
        - Recommended immediate actions
        - Timeline of events
        &quot;&quot;&quot;
        
        correlation_response = await self.ai_pipeline.execute_pipeline(
            PipelineStepType.SECURITY_CORRELATION_ANALYSIS,
            {&quot;prompt&quot;: correlation_prompt},
            {&quot;threats_count&quot;: len(detected_threats), &quot;anomalies_count&quot;: len(behavioral_anomalies)}
        )
        
        return [SecurityIncident.from_ai_analysis(incident_data) for incident_data in correlation_response.get(&quot;incidents&quot;, [])]</code></pre>

<h3>The Penetration Testing Gauntlet</h3>

<p>Il momento della verit√† √® arrivato quando i potenziali clienti enterprise hanno ingaggiato una security firm per fare <strong>penetration testing</strong> del nostro sistema.</p>

<p><em>Data del Pen Test: 5 Ottobre</em></p>

<p>Per 3 giorni, ethical hackers professionisti hanno tentato di penetrare ogni aspetto del nostro sistema. I risultati sono stati... educativi.</p>

<p><em>Penetration Test Results Summary:</em></p>

<pre><code class="language-text">PENETRATION TEST RESULTS (3-day assessment):

üî¥ CRITICAL FINDINGS: 2
- SQL injection possibility in legacy API endpoint
- Insufficient session timeout allowing token replay attacks

üü† HIGH FINDINGS: 5  
- Missing rate limiting on password reset functionality
- Inadequate input sanitization in user-generated content
- Weak encryption key derivation in one legacy module
- Information disclosure in error messages
- Missing security headers on some endpoints

üü° MEDIUM FINDINGS: 12
- Various input validation improvements needed
- Logging insufficient for forensic analysis
- Some dependencies with known vulnerabilities
- Suboptimal security configurations

‚úÖ POSITIVE FINDINGS:
- Overall architecture well-designed
- Authentication system robust
- Data encryption properly implemented  
- GDPR compliance well-architected
- Incident response procedures solid

OVERALL SECURITY SCORE: 7.2/10 (Acceptable for enterprise, needs improvements)</code></pre>

<h3>Security Hardening Sprint: 72 Hours to Fix Everything</h3>

<p>Con i pen test results in mano, abbiamo avuto 72 ore per fixare tutti i critical e high findings prima della security review finale.</p>

<pre><code class="language-python">class EmergencySecurityHardening:
    &quot;&quot;&quot;
    Rapid security hardening per critical vulnerabilities
    &quot;&quot;&quot;
    
    async def fix_critical_vulnerabilities(
        self,
        vulnerabilities: List[SecurityVulnerability]
    ) -&gt; SecurityHardeningResult:
        &quot;&quot;&quot;
        Emergency patching of critical security vulnerabilities
        &quot;&quot;&quot;
        hardening_results = []
        
        for vulnerability in vulnerabilities:
            if vulnerability.severity == SeverityLevel.CRITICAL:
                # Critical vulnerabilities get immediate attention
                fix_result = await self._apply_critical_fix(vulnerability)
                hardening_results.append(fix_result)
                
                # Immediate verification
                verification_result = await self._verify_vulnerability_fixed(vulnerability, fix_result)
                if not verification_result.confirmed_fixed:
                    logger.critical(f&quot;Critical vulnerability {vulnerability.id} not properly fixed!&quot;)
                    raise SecurityHardeningException(f&quot;Failed to fix critical vulnerability: {vulnerability.id}&quot;)
        
        return SecurityHardeningResult(
            vulnerabilities_addressed=len(hardening_results),
            critical_fixes_applied=[r for r in hardening_results if r.vulnerability.severity == SeverityLevel.CRITICAL],
            verification_passed=all(r.verification_confirmed for r in hardening_results),
            hardening_completion_time=datetime.utcnow()
        )
    
    async def _apply_critical_fix(
        self,
        vulnerability: SecurityVulnerability
    ) -&gt; SecurityFixResult:
        &quot;&quot;&quot;
        Apply specific fix for critical vulnerability
        &quot;&quot;&quot;
        if vulnerability.vulnerability_type == VulnerabilityType.SQL_INJECTION:
            # Fix SQL injection with parameterized queries
            return await self._fix_sql_injection(vulnerability)
            
        elif vulnerability.vulnerability_type == VulnerabilityType.SESSION_REPLAY:
            # Fix session replay with proper token rotation
            return await self._fix_session_replay(vulnerability)
            
        elif vulnerability.vulnerability_type == VulnerabilityType.PRIVILEGE_ESCALATION:
            # Fix privilege escalation with proper access controls
            return await self._fix_privilege_escalation(vulnerability)
            
        else:
            # Generic security fix
            return await self._apply_generic_security_fix(vulnerability)</code></pre>

<h3>Production Results: From Vulnerable to Fortress</h3>

<p>Dopo 6 settimane di enterprise security hardening:</p>

<table>
<thead>
<tr>
<th>Security Metric</th>
<th>Pre-Hardening</th>
<th>Post-Hardening</th>
<th>Improvement</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Penetration Test Score</strong></td>
<td>Unknown (likely 4/10)</td>
<td>8.7/10</td>
<td><strong>+117% security posture</strong></td>
</tr>
<tr>
<td><strong>GDPR Compliance</strong></td>
<td>0% compliant</td>
<td>98% compliant</td>
<td><strong>Full compliance achieved</strong></td>
</tr>
<tr>
<td><strong>SOC 2 Readiness</strong></td>
<td>0% ready</td>
<td>85% ready</td>
<td><strong>Enterprise audit ready</strong></td>
</tr>
<tr>
<td><strong>Security Incidents (detected)</strong></td>
<td>0 (no monitoring)</td>
<td>23/month (early detection)</td>
<td><strong>Proactive threat detection</strong></td>
</tr>
<tr>
<td><strong>Data Breach Risk</strong></td>
<td>High (unprotected)</td>
<td>Low (multi-layer protection)</td>
<td><strong>95% risk reduction</strong></td>
</tr>
<tr>
<td><strong>Enterprise Sales Cycle</strong></td>
<td>Blocked by security</td>
<td>3 weeks average</td>
<td><strong>Security enabler not blocker</strong></td>
</tr>
</tbody>
</table>

<h3>The Security-Performance Paradox</h3>

<p>Una lezione importante che abbiamo imparato √® che la sicurezza enterprise ha un <strong>performance cost</strong> nascosto:</p>

<p><strong>Security Overhead Measurements:</strong>
- <strong>Authentication</strong>: +200ms per request (MFA, risk assessment)
- <strong>Encryption</strong>: +50ms per data operation (encryption/decryption)
- <strong>Audit Logging</strong>: +30ms per action (comprehensive logging)
- <strong>Access Control</strong>: +100ms per permission check (granular RBAC)</p>

<p><strong>Total Security Tax: ~380ms per user interaction</strong></p>

<p>Ma abbiamo anche scoperto che i clienti enterprise <strong>valutano la sicurezza pi√π della velocit√†</strong>. Un sistema sicuro con 1.5s di latency era preferibile a un sistema veloce ma vulnerabile con 0.5s di latency.</p>

<h3>The Cultural Transformation: From "Move Fast" to "Move Secure"</h3>

<p>Il security hardening ci ha costretto a cambiare la nostra cultura aziendale da <strong>"move fast and break things"</strong> a <strong>"move secure and protect things"</strong>.</p>

<p><strong>Cultural Changes Implemented:</strong>
1. <strong>Security Review Mandatory</strong>: Ogni feature passa security review prima del deploy
2. <strong>Threat Modeling Standard</strong>: Ogni nuova funzionalit√† viene analizzata per threat vectors
3. <strong>Incident Response Drills</strong>: Monthly security incident simulations
4. <strong>Security Champions Program</strong>: Ogni team ha un security champion
5. <strong>Compliance-First Development</strong>: GDPR/SOC2 considerations in ogni decisione</p>

<div class="key-takeaways-section">
    <h4 class="key-takeaways-title">üìù Key Takeaways del Capitolo:</h4>
    <div class="key-takeaways-content"><p class="takeaway-item">‚úì <strong>Enterprise Security is a Mindset Shift:</strong> From functional security to paranoid security - assume everything will be attacked.</p>
<p class="takeaway-item">‚úì <strong>Security Has Performance Costs:</strong> Every security layer adds latency, but enterprise customers value security over speed.</p>
<p class="takeaway-item">‚úì <strong>GDPR is More Than Encryption:</strong> Data lifecycle, consent management, and user rights require comprehensive system redesign.</p>
<p class="takeaway-item">‚úì <strong>Penetration Testing Reveals Truth:</strong> Your security is only as strong as external attackers say it is, not as strong as you think.</p>
<p class="takeaway-item">‚úì <strong>Security Culture Transformation Required:</strong> Team culture must shift from "move fast" to "move secure" for enterprise readiness.</p>
<p class="takeaway-item">‚úì <strong>Compliance is a Competitive Advantage:</strong> SOC 2 and GDPR compliance become sales enablers, not blockers, in enterprise markets.</p>
    </div>
</div>

<p><strong>Conclusione del Capitolo</strong></p>

<p>L'Enterprise Security Hardening ci ha trasformato da una startup agile ma vulnerabile a una piattaforma enterprise-ready e sicura. Ma pi√π importante, ci ha insegnato che <strong>la sicurezza non √® una feature che aggiungi</strong> ‚Äì √® una <strong>filosofia che abbraccia</strong> ogni decisione che prendi.</p>

<div class="war-story" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 15px; margin: 25px 0; box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);">
    <div style="display: flex; align-items: center; margin-bottom: 15px;">
        <svg style="width: 28px; height: 28px; margin-right: 12px; fill: #FFD700;" viewBox="0 0 24 24">
            <path d="M12,2A2,2 0 0,1 14,4V8H18A2,2 0 0,1 20,10V19A2,2 0 0,1 18,21H6A2,2 0 0,1 4,19V10C4,8.89 4.89,8 6,8H10V4A2,2 0 0,1 12,2M12,4V8H14V4H12Z"/>
        </svg>
        <h4 style="margin: 0; font-size: 1.3em;">üíº I Cicli di Vendita dei Sistemi Agentici</h4>
    </div>
    <div style="font-size: 1.1em; line-height: 1.6;">
        <p style="margin: 0 0 15px 0;">
            <strong>Tomasz Tunguz</strong> osserva che vendere sistemi agentici differisce dal software tradizionale: <em>"Non c'√® una checklist statica di feature da spuntare, ma un continuum di performance"</em>. I buyer enterprise vogliono vedere come l'AI si comporta sui <strong>loro dati specifici</strong>, non solo sui benchmark generici.
        </p>
        
        <p style="margin: 0 0 15px 0;">
            <strong>Implicazioni per i cicli di vendita:</strong> PoC approfonditi diventano obbligatori, trial periods pi√π lunghi (per osservare comportamenti autonomi), e necessit√† di dimostrare trasparenza e kill-switch per sistemi critici. Nel lungo termine, Tunguz prevede standard di settore o "Gartner per Agentic AI" che certifichino questi sistemi.
        </p>
        
        <p style="margin: 0; font-style: italic;">
            <strong>Lesson learned:</strong> Progettare architettura modulare (come nel nostro libro) facilita fine-tuning e demo personalizzate. Logging, explainability e circuit breaker non sono solo robustezza tecnica ‚Äì sono <strong>requisiti per superare le due diligence enterprise</strong>.
        </p>
    </div>
</div>

<p>Con il sistema ora sicuro, compliant, e audit-ready, eravamo pronti per l'ultima sfida del nostro journey: <strong>Global Scale Architecture</strong>. Perch√© non basta avere un sistema che funziona per 1,000 utenti in Italia ‚Äì deve funzionare per 100,000 utenti distribuiti in 50 paesi, ciascuno con le proprie leggi sulla privacy, le proprie latenze di rete, e le proprie aspettative culturali.</p>

<p>La strada verso la dominazione globale era lastricata di sfide tecniche che avremmo dovuto conquistare una timezone alla volta.</p>
            </div>

            
        </article>

        <!-- Bottom Navigation -->
        <div class="container">
    <nav class="chapter-nav-bottom">
            <a href="../load-testing-shock-successo-nemico/" class="nav-button secondary">‚Üê Capitolo Precedente</a>
            <a href="../global-scale-architecture-timezone/" class="nav-button">Prossimo Capitolo ‚Üí</a>
        </nav>
    </div>
</div>

                <!-- Reader Tools -->
        <div class="reader-tools" id="readerTools">
            <button class="reader-tools-toggle" onclick="toggleReaderTools()">‚öô</button>
            <div class="reader-tool" onclick="toggleTheme()">
                <span class="reader-tool-icon" id="themeIcon">üåô</span>
                <span class="reader-tool-label">Tema</span>
            </div>
            <div class="reader-tool" onclick="toggleBookmark()">
                <span class="reader-tool-icon">üîñ</span>
                <span class="reader-tool-label">Bookmark</span>
            </div>
            <div class="reader-tool" onclick="showBookmarks()">
                <span class="reader-tool-icon">üìö</span>
                <span class="reader-tool-label">I Miei Bookmark</span>
            </div>
            <div class="reader-tool">
                <span class="reader-tool-icon">üåê</span>
                <select class="language-select" onchange="switchLanguage(this.value)">
                    <option value="it" selected>Italiano</option>
                    <option value="en">English</option>
                </select>
            </div>
            <div class="reader-tool" onclick="showFontSizeMenu()">
                <span class="reader-tool-icon">üî§</span>
                <span class="reader-tool-label">Dimensione Font</span>
            </div>
        </div>
        
        <!-- Reading Progress -->
        <div class="reading-progress">
            <div class="reading-progress-fill" id="progressFill"></div>
        </div>
        
        <!-- Bookmark Toast -->
        <div class="bookmark-toast" id="bookmarkToast">
            <span id="bookmarkMessage">Bookmark salvato!</span>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#2c3e50',
                primaryBorderColor: '#667eea',
                lineColor: '#7f8c8d',
                secondaryColor: '#f8f9fa',
                tertiaryColor: '#ffffff'
            }
        });
    </script>

    <!-- Prism.js for code highlighting -->
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VEGK4VZMG0"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-VEGK4VZMG0');
        
        gtag('event', 'chapter_start', {
            'chapter_title': 'Enterprise Security Hardening ‚Äì Dalla Fiducia alla Paranoia',
            'movement': 'memory-system-scaling',
            'chapter_number': 40
        });
    </script>

        
        
        <!-- Reading Progress -->
        <div class="reading-progress">
            <div class="reading-progress-fill" id="progressFill"></div>
        </div>
        
        <!-- Bookmark Toast -->
        <div class="bookmark-toast" id="bookmarkToast">
            <span id="bookmarkMessage">Bookmark salvato!</span>
        
    <!-- Related Chapters Section -->
    <div class="related-chapters-section" id="related-chapters-section">
        <div class="related-chapters-header">
            <h3>üîó Capitoli Correlati</h3>
            <p>Esplora questi capitoli per approfondire i concetti correlati</p>
        </div>
        <div class="related-chapters-grid">
            
            <div class="related-chapter-item">
                <h4><a href="/it/filosofia-core-architettura/agent-toolbox/" class="related-link">Cassetta degli Attrezzi dell'Agente</a></h4>
                <p>Master AI systems with proven enterprise strategies and <a href="/it/memory-system-scaling/production-readiness-audit-moment-truth/" class="contextual-link" title="strategie di readiness produttiva">production-ready</a> patterns.</p>
                <a href="/it/filosofia-core-architettura/agent-toolbox/" class="related-cta">Approfondisci ‚Üí</a>
            </div>
        
            <div class="related-chapter-item">
                <h4><a href="/it/filosofia-core-architettura/15-pillars-ai-system/" class="related-link">15 Pilastri del Sistema AI</a></h4>
                <p>Master enterprise architecture with proven enterprise strategies and <a href="/it/memory-system-scaling/production-readiness-audit-moment-truth/" class="contextual-link" title="strategie di readiness produttiva">production-ready</a> patterns.</p>
                <a href="/it/filosofia-core-architettura/15-pillars-ai-system/" class="related-cta">Approfondisci ‚Üí</a>
            </div>
        
            <div class="related-chapter-item">
                <h4><a href="/it/filosofia-core-architettura/orchestrator-conductor/" class="related-link">Orchestratore come Direttore</a></h4>
                <p>Master production deployment with proven enterprise strategies and <a href="/it/memory-system-scaling/production-readiness-audit-moment-truth/" class="contextual-link" title="strategie di readiness produttiva">production-ready</a> patterns.</p>
                <a href="/it/filosofia-core-architettura/orchestrator-conductor/" class="related-cta">Approfondisci ‚Üí</a>
            </div>
        
        </div>
    </div>
    
    <style>
    .related-chapters-section {
        margin: 3rem 0;
        padding: 2rem;
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-radius: 15px;
        border-left: 5px solid #667eea;
    }
    
    .related-chapters-header {
        text-align: center;
        margin-bottom: 2rem;
    }
    
    .related-chapters-header h3 {
        color: #2c3e50;
        font-size: 1.8rem;
        margin-bottom: 0.5rem;
    }
    
    .related-chapters-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
    }
    
    .related-chapter-item {
        background: white;
        padding: 1.5rem;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
    }
    
    .related-chapter-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
    }
    
    .related-link {
        color: #667eea;
        text-decoration: none;
        font-weight: 600;
    }
    
    .related-link:hover {
        color: #5a6fd8;
        text-decoration: underline;
    }
    
    .related-cta {
        color: #667eea;
        text-decoration: none;
        font-weight: 600;
        font-size: 0.9rem;
        display: inline-flex;
        align-items: center;
        gap: 0.3rem;
        margin-top: 1rem;
    }
    
    .related-cta:hover {
        color: #5a6fd8;
    }
    
    /* Dark mode support */
    .dark-mode .related-chapters-section {
        background: rgba(255, 255, 255, 0.05);
        color: #e9ecef;
    }
    
    .dark-mode .related-chapters-header h3 {
        color: #e9ecef;
    }
    
    .dark-mode .related-chapter-item {
        background: rgba(255, 255, 255, 0.05);
        color: #e9ecef;
    }
    </style>
    
    <!-- Continue Reading Section -->
    <div class="continue-reading-section">
        <div class="continue-reading-header">
            <h3>üìö Continua la Lettura</h3>
        </div>
        <div class="continue-reading-actions">
            <a href="/it/ai-team-orchestrator.html" class="continue-btn primary">
                <span class="btn-icon">üè†</span>
                <span class="btn-text">Torna alla Guida</span>
            </a>
            <a href="/it/filosofia-core-architettura/" class="continue-btn secondary">
                <span class="btn-icon">üé≠</span>
                <span class="btn-text">Esplora il Movimento</span>
            </a>
        </div>
    </div>
    
    <style>
    .continue-reading-section {
        margin: 2rem 0;
        padding: 1.5rem;
        text-align: center;
        background: linear-gradient(135deg, #667eea10, #764ba210);
        border-radius: 15px;
    }
    
    .continue-reading-header h3 {
        color: #2c3e50;
        margin-bottom: 1rem;
    }
    
    .continue-reading-actions {
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .continue-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.8rem 1.5rem;
        border-radius: 25px;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.3s ease;
    }
    
    .continue-btn.primary {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
    }
    
    .continue-btn.secondary {
        background: rgba(102, 126, 234, 0.1);
        color: #667eea;
        border: 2px solid #667eea;
    }
    
    .continue-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
    }
    
    .dark-mode .continue-reading-header h3 {
        color: #e9ecef;
    }
    </style>
    </div>

    <script>

        // Reader Tools JavaScript
        let readerToolsCollapsed = false;
        
        // Initialize reader tools
        document.addEventListener('DOMContentLoaded', function() {
            initializeReaderTools();
            updateReadingProgress();
            loadUserPreferences();
        });
        
        // Toggle reader tools visibility
        function toggleReaderTools() {
            const tools = document.getElementById('readerTools');
            readerToolsCollapsed = !readerToolsCollapsed;
            
            if (readerToolsCollapsed) {
                tools.classList.add('collapsed');
            } else {
                tools.classList.remove('collapsed');
            }
            
            localStorage.setItem('readerToolsCollapsed', readerToolsCollapsed);
        }
        
        // Theme toggle functionality
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('themeIcon');
            const isDarkMode = body.classList.contains('dark-mode');
            
            if (isDarkMode) {
                body.classList.remove('dark-mode');
                themeIcon.textContent = 'üåô';
                localStorage.setItem('theme', 'light');
            } else {
                body.classList.add('dark-mode');
                themeIcon.textContent = '‚òÄÔ∏è';
                localStorage.setItem('theme', 'dark');
            }
        }
        
        // Bookmark functionality
        function toggleBookmark() {
            const currentPage = window.location.pathname;
            const pageTitle = document.querySelector('.chapter-title').textContent;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarks') || '[]');
            const existingIndex = bookmarks.findIndex(b => b.url === currentPage);
            
            if (existingIndex > -1) {
                bookmarks.splice(existingIndex, 1);
                showToast('Bookmark rimosso!', 'error');
            } else {
                bookmarks.push({
                    url: currentPage,
                    title: pageTitle,
                    timestamp: new Date().toISOString()
                });
                showToast('Bookmark salvato!', 'success');
            }
            
            localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
        }
        
        // Language switching
        function switchLanguage(lang) {
            const currentPath = window.location.pathname;
            let newPath;
            
            if (lang === 'en') {
                newPath = currentPath.replace('/it/', '/en/')
                    .replace('filosofia-core-architettura', 'core-philosophy-architecture')
                    .replace('user-experience-trasparenza', 'user-experience-transparency')
                    .replace('esecuzione-qualita', 'execution-quality')
                    .replace('memory-system-scaling', 'memory-system-scaling')
                    .replace('i-15-pilastri-sistema-ai', '15-pillars-ai-system')
                    .replace('primo-agente-specialist-architecture', 'first-specialist-agent-architecture')
                    .replace('isolare-intelligenza-mock-llm', 'ai-mocking-testing-strategy')
                    .replace('dramma-parsing-contratto-ai', 'drama-parsing-ai-contracts')
                    .replace('sdk-vs-api-battle', 'sdk-vs-direct-api-battle')
                    .replace('agente-ambiente-interazioni-fondamentali', 'agent-environment-interactions')
                    .replace('orchestratore-direttore-orchestra', 'orchestrator-conductor')
                    .replace('staffetta-mancata-handoff', 'failed-handoff-delegation')
                    .replace('recruiter-ai-team-dinamico', 'ai-recruiter-dynamic-team')
                    .replace('test-tool-ancorare-realta', 'tool-testing-reality-anchor')
                    .replace('cassetta-attrezzi-agente', 'agent-toolbox');
            } else if (lang === 'it') {
                newPath = currentPath.replace('/en/', '/it/')
                    .replace('core-philosophy-architecture', 'filosofia-core-architettura')
                    .replace('user-experience-transparency', 'user-experience-trasparenza')
                    .replace('execution-quality', 'esecuzione-qualita')
                    .replace('memory-system-scaling', 'memory-system-scaling')
                    .replace('15-pillars-ai-system', 'i-15-pilastri-sistema-ai')
                    .replace('first-specialist-agent-architecture', 'primo-agente-specialist-architecture')
                    .replace('ai-mocking-testing-strategy', 'isolare-intelligenza-mock-llm')
                    .replace('drama-parsing-ai-contracts', 'dramma-parsing-contratto-ai')
                    .replace('sdk-vs-direct-api-battle', 'sdk-vs-api-battle')
                    .replace('agent-environment-interactions', 'agente-ambiente-interazioni-fondamentali')
                    .replace('orchestrator-conductor', 'orchestratore-direttore-orchestra')
                    .replace('failed-handoff-delegation', 'staffetta-mancata-handoff')
                    .replace('ai-recruiter-dynamic-team', 'recruiter-ai-team-dinamico')
                    .replace('tool-testing-reality-anchor', 'test-tool-ancorare-realta')
                    .replace('agent-toolbox', 'cassetta-attrezzi-agente');
            }
            
            if (newPath && newPath !== currentPath) {
                window.location.href = newPath;
            }
        }
        
        // Font size menu (simplified)
        function showFontSizeMenu() {
            const currentSize = localStorage.getItem('fontSize') || 'medium';
            let newSize;
            
            switch (currentSize) {
                case 'small':
                    newSize = 'medium';
                    break;
                case 'medium':
                    newSize = 'large';
                    break;
                case 'large':
                    newSize = 'small';
                    break;
                default:
                    newSize = 'medium';
            }
            
            setFontSize(newSize);
            localStorage.setItem('fontSize', newSize);
            showToast(`Dimensione font: ${newSize}`, 'success');
        }
        
        // Set font size
        function setFontSize(size) {
            const root = document.documentElement;
            const sizes = {
                small: '0.9',
                medium: '1.0',
                large: '1.1'
            };
            root.style.fontSize = sizes[size] + 'em';
        }
        
        // Show toast notification (improved)
        function showToast(message, type = 'success') {
            const toast = document.getElementById('bookmarkToast');
            const messageEl = document.getElementById('bookmarkMessage');
            
            if (!toast || !messageEl) return;
            
            // Clear any existing timeouts
            if (window.toastTimeout) {
                clearTimeout(window.toastTimeout);
            }
            
            // Reset classes and set message
            toast.classList.remove('show', 'error');
            messageEl.textContent = message;
            
            // Add appropriate classes
            if (type === 'error') {
                toast.classList.add('error');
            }
            
            // Show toast
            toast.classList.add('show');
            
            // Hide after delay
            window.toastTimeout = setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Reading progress
        function updateReadingProgress() {
            const progressFill = document.getElementById('progressFill');
            
            window.addEventListener('scroll', () => {
                const article = document.querySelector('.chapter-content');
                if (!article) return;
                
                const articleTop = article.offsetTop;
                const articleHeight = article.offsetHeight;
                const windowHeight = window.innerHeight;
                const scrollTop = window.pageYOffset;
                
                const progress = Math.min(100, Math.max(0, 
                    ((scrollTop + windowHeight - articleTop) / articleHeight) * 100
                ));
                
                progressFill.style.width = progress + '%';
            });
        }
        
        // Load user preferences
        function loadUserPreferences() {
            // Load theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';
            }
            
            // Load font size
            const savedFontSize = localStorage.getItem('fontSize');
            if (savedFontSize) {
                setFontSize(savedFontSize);
            }
            
            // Load reader tools state
            const toolsCollapsed = localStorage.getItem('readerToolsCollapsed') === 'true';
            if (toolsCollapsed) {
                document.getElementById('readerTools').classList.add('collapsed');
                readerToolsCollapsed = true;
            }
        }
        
        // Initialize reader tools
        function initializeReaderTools() {
            // Check if current page is bookmarked
            const currentPage = window.location.pathname;
            const bookmarks = JSON.parse(localStorage.getItem('bookmarks') || '[]');
            const isBookmarked = bookmarks.some(b => b.url === currentPage);
            
            if (isBookmarked) {
                document.querySelector('.reader-tool:nth-child(3)').classList.add('active');
            }
        
    
        // Show bookmarks modal
        function showBookmarks() {
            const modal = document.getElementById('bookmarksModal');
            const bookmarksList = document.getElementById('bookmarksList');
            const bookmarks = JSON.parse(localStorage.getItem('bookmarks') || '[]');
            
            if (bookmarks.length === 0) {
                bookmarksList.innerHTML = `
                    <div class="no-bookmarks">
                        <div class="no-bookmarks-icon">üìö</div>
                        <h3>Nessun bookmark salvato</h3>
                        <p>Inizia a salvare i tuoi capitoli preferiti cliccando sull'icona üîñ</p>
                    </div>`;
            } else {
                bookmarksList.innerHTML = bookmarks.map(bookmark => `
                    <div class="bookmark-item">
                        <a href="${bookmark.url}" class="bookmark-link">
                            <div class="bookmark-title">${bookmark.title}</div>
                            <div class="bookmark-date">${new Date(bookmark.date).toLocaleDateString('it-IT')}</div>
                        </a>
                        <button class="delete-bookmark" onclick="deleteBookmark('${bookmark.url}')">üóëÔ∏è</button>
                    </div>
                `).join('');
            }
            
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
        
        function closeBookmarksModal(event) {
            const modal = document.getElementById('bookmarksModal');
            if (modal && (!event || event.target === modal)) {
                modal.style.display = 'none';
                document.body.style.overflow = '';
            }
        }
        
        function deleteBookmark(url) {
            let bookmarks = JSON.parse(localStorage.getItem('bookmarks') || '[]');
            bookmarks = bookmarks.filter(b => b.url !== url);
            localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
            showToast('Bookmark removed!', 'error');
            showBookmarks();
        }
        
        function showToast(message, type = 'success') {
            let toast = document.getElementById('bookmarkToast');
            if (!toast) return;
            
            const messageEl = document.getElementById('bookmarkMessage');
            if (messageEl) messageEl.textContent = message;
            
            toast.style.background = type === 'error' ? '#dc3545' : '#28a745';
            toast.style.opacity = '1';
            toast.style.transform = 'translateY(0)';
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateY(-10px)';
            }, 3000);
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            const currentPage = window.location.pathname;
            const bookmarks = JSON.parse(localStorage.getItem('bookmarks') || '[]');
            const isBookmarked = bookmarks.some(b => b.url === currentPage);
            
            const bookmarkTool = document.querySelector('.reader-tool[onclick*="toggleBookmark"]');
            if (bookmarkTool) {
                bookmarkTool.classList.toggle('active', isBookmarked);
            }
            
            // Load saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                const themeIcon = document.getElementById('themeIcon');
                if (themeIcon) themeIcon.textContent = '‚òÄÔ∏è';
            }
        });
    
        }
    </script>

<!-- universal-progress-bar-added -->
</body>
</html>